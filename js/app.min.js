!function(){var e=function(){function e(e,n){function t(e){var n=$(e).find("span.overflow_ellipsis").first().clone().text().trim().replace(/\r?\n/g,"");return"#"==n.substring(0,1)&&(n=n.substring(1).trim()),n}return t(e).localeCompare(t(n))}function n(n){var t=$("li",n);t.sort(e),n.empty(),t.each(function(e,t){n.append(t)})}function t(){TS.client.channel_pane.rebuildImList(),TS.client.channel_pane.rebuildGroupList(),TS.client.channel_pane.rebuildStarredList(),TS.client.channel_pane.rebuildChannelList()}function a(e){var n=$("<div>").html(e),t=$("<li>",{id:"channel_info_change"}).html("<a>Set Channel Info</a>");return t.insertAfter(n.find("li.divider").first()),n.html()}function i(e,n){var t=$("<div>").html(e),a=t.find("a."+n+"_name").attr("href"),i=t.find("a."+n+"_name").data(n+"-id"),l="group"==n?"ts_icon_lock":"ts_icon_channel_pane_hash";try{var r=s.getData(i);if(!r.icon&&!r.alias)return e;var c=t.find("span.overflow_ellipsis");c.empty();try{var o=$(TS.emoji.graphicReplace(r.icon,{force_img:!0}));o.attr("src")?o.css("margin","-2px 3px 0 "):o=$("<ts-icon>").attr("class",l+" prefix")}catch(d){o=$("<ts-icon>").attr("class",l+" prefix")}"group"==n&&t.find("ts-icon").first().remove();var m=r.alias?r.alias:a.split("/")[2];return c.prepend(o),c.append(m),t.html()}catch(d){return console.error(d),e}}var l="conf_hide_msg_ids",s={getData:function(e){var n=window.localStorage.getItem(s.getChannelKey(e));return n?JSON.parse(n):{icon:"",alias:""}},getChannelKey:function(e){return"conf_sidebar_"+e},html:function(){return'<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button><h3>Set info for channel #<span id="ch_title"></span></h3></div><div class="modal-body"><p class="top_margin"><label for="ch_alias" class="inline_block">Sidebar Alias</label><input id="ch_alias" type="text" class="small"><span class="modal_input_note">Add channel alias. Set a custom sidebar name for this channel.</span></p><p class="top_margin"><label for="ch_icon" class="inline_block">Emoji Icon</label><input id="ch_icon" type="text" class="small"><span class="modal_input_note">Change channel emoji icon. Paste your emoji code here like <code>:book:</code></span></p></div><div class="modal-footer"><a class="btn btn_save">Save Settings</a></div>'},show:function(e){var n=$("div#change_icon_dialog");n.length||(n=$("<div>",{id:"change_icon_dialog","class":"modal hide fade in","aria-hidden":"false"}).html(s.html()),$(document.body).append(n));var a=s.getData(TS.model.active_cid);n.find("#ch_icon").val(a.icon),n.find("#ch_alias").val($("<span>").html(a.alias).text()),n.find("span#ch_title").text(e),n.find("a.btn_save").click(function(e){e.preventDefault(),window.localStorage.setItem(s.getChannelKey(TS.model.active_cid),JSON.stringify({icon:TS.utility.htmlEntities($("#ch_icon").val().trim()),alias:TS.utility.htmlEntities($("#ch_alias").val().trim())})),t(),n.modal("hide")}),n.modal("show")}},r=TS.client.channel_pane.rebuildStarredList;TS.client.channel_pane.rebuildStarredList=function(){r(),n($("ul#starred-list"))};var c=TS.client.channel_pane.rebuildChannelList;TS.client.channel_pane.rebuildChannelList=function(){c(),n($("ul#channel-list"))};var o=TS.client.msg_pane.rebuildMsgs;TS.client.msg_pane.rebuildMsgs=function(){o();var e=$("div.day_container");e.length&&e.each(function(e,n){var t=$(n),a=t.find("div.day_msgs");a.length&&""!=a.first().html()||t.remove()})};var d=TS.templates.menu_channel_items;TS.templates.menu_channel_items=function(e){return a(d(e))};var m=TS.templates.menu_group_items;TS.templates.menu_group_items=function(e){return a(m(e))};var p=TS.templates.menu_message_action_items;TS.templates.menu_message_action_items=function(e){var n=$("<div>").html(p(e)),t=$("<li>",{id:"hide_link","class":"danger","data-ts-message-id":TS.templates.makeMsgDomId(e.msg.ts)}).html("<a>Hide message (for me)</a>");return n.find("li.divider").length||n.append($("<li>",{"class":"divider"})),n.append(t),n.html()};var h=TS.templates.member;TS.templates.member=function(e){var n=h(e),t=$("<div>").html(n),a=$("<img>");a.attr("src",e.member.profile.image_24),a.css("display","inline-block"),a.css("margin","0 0 5px 5px"),a.css("border-radius","3px"),a.css("height","20px"),a.css("width","20px");var i=t.find("i.slackbot_icon");return i.length?a.insertAfter($(i)):a.insertAfter(t.find("span.presence").first()),t.html()};var u=TS.templates.channel;TS.templates.channel=function(e){var n=u(e);return i(n,"channel")};var f=TS.templates.group;TS.templates.group=function(e){var n=f(e);return i(n,"group")};var _=TS.templates.message;TS.templates.message=function(e){var n=_(e),t=$("<div>").html(n),a=t.find("ts-message").first().attr("id"),i=JSON.parse(window.localStorage.getItem(l));return i&&i.hasOwnProperty(a)&&i[a]?"":n},$(document.body).on("click",'[id="channel_info_change"]',function(e){e.preventDefault(),s.show(TS.shared.getActiveModelOb().name),TS.menu.end()}),$(document.body).on("click",'[id="hide_link"]',function(e){var n=$(this).data("ts-message-id"),t=JSON.parse(window.localStorage.getItem(l));t=t?t:{},t[n]=!0,window.localStorage.setItem(l,JSON.stringify(t)),TS.client.msg_pane.rebuildMsgs()}),t()},n=document.createElement("script");n.type="text/javascript",n.innerHTML="("+e.toString()+")();",document.body.appendChild(n)}();