!function(){var e=function(){function e(e,t){function a(e){var t=$(e).find("span.overflow_ellipsis").first().clone().text().trim().replace(/\r?\n/g,"");return"#"==t.substring(0,1)&&(t=t.substring(1).trim()),t}return a(e).localeCompare(a(t))}function t(t){var a=$("li",t);a.sort(e),t.empty(),a.each(function(e,a){t.append(a)})}function a(){TS.client.channel_pane.rebuildImList(),TS.client.channel_pane.rebuildGroupList(),TS.client.channel_pane.rebuildStarredList(),TS.client.channel_pane.rebuildChannelList()}function n(e){var t=$("<div>").html(e),a=$("<li>",{id:"channel_info_change"}).html("<a>Set Channel Info</a>");return a.insertAfter(t.find("li.divider").first()),t.html()}function i(e,t){var a=$("<div>").html(e),n=a.find("a."+t+"_name").attr("href"),i=a.find("a."+t+"_name").data(t+"-id"),s="group"==t?"ts_icon_lock":"ts_icon_channel_pane_hash";try{var r=l.getData(i);if(!r.icon&&!r.alias)return e;var c=a.find("span.overflow_ellipsis");c.empty();try{var o=$(TS.emoji.graphicReplace(r.icon,{force_img:!0}));o.attr("src")?o.css("margin","-2px 3px 0 "):o=$("<ts-icon>").attr("class",s+" prefix")}catch(d){o=$("<ts-icon>").attr("class",s+" prefix")}"group"==t&&a.find("ts-icon").first().remove();var m=r.alias?r.alias:n.split("/")[2];return c.prepend(o),c.append(m),a.html()}catch(d){return console.error(d),e}}var s="conf_hide_msg_ids",l={getData:function(e){var t=window.localStorage.getItem(l.getChannelKey(e));return t?JSON.parse(t):{icon:"",alias:""}},getChannelKey:function(e){return"conf_sidebar_"+e},html:function(){return'<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button><h3>Set info for channel #<span id="ch_title"></span></h3></div><div class="modal-body"><p class="top_margin"><label for="ch_alias" class="inline_block">Sidebar Alias</label><input id="ch_alias" type="text" class="small"><span class="modal_input_note">Add channel alias. Set a custom sidebar name for this channel.</span></p><p class="top_margin"><label for="ch_icon" class="inline_block">Emoji Icon</label><input id="ch_icon" type="text" class="small"><span class="modal_input_note">Change channel emoji icon. Paste your emoji code here like <code>:book:</code></span></p></div><div class="modal-footer"><a class="btn btn_save">Save Settings</a></div>'},show:function(e){var t=$("div#change_icon_dialog");t.length||(t=$("<div>",{id:"change_icon_dialog","class":"modal hide fade in","aria-hidden":"false"}).html(l.html()),$(document.body).append(t));var n=l.getData(TS.model.active_cid);t.find("#ch_icon").val(n.icon),t.find("#ch_alias").val($("<span>").html(n.alias).text()),t.find("span#ch_title").text(e),t.find("a.btn_save").click(function(e){e.preventDefault(),window.localStorage.setItem(l.getChannelKey(TS.model.active_cid),JSON.stringify({icon:TS.utility.htmlEntities($("#ch_icon").val().trim()),alias:TS.utility.htmlEntities($("#ch_alias").val().trim())})),a(),t.modal("hide")}),t.modal("show")}},r=TS.client.channel_pane.rebuildStarredList;TS.client.channel_pane.rebuildStarredList=function(){r(),t($("ul#starred-list"))};var c=TS.client.channel_pane.rebuildChannelList;TS.client.channel_pane.rebuildChannelList=function(){c(),t($("ul#channel-list"))};var o=TS.client.msg_pane.rebuildMsgs;TS.client.msg_pane.rebuildMsgs=function(){o();var e=$("div.day_container");e.length&&e.each(function(e,t){var a=$(t),n=a.find("div.day_msgs");n.length&&""!=n.first().html()||a.remove()})};var d=TS.templates.menu_channel_items;TS.templates.menu_channel_items=function(e){return n(d(e))};var m=TS.templates.menu_group_items;TS.templates.menu_group_items=function(e){return n(m(e))};var p=TS.templates.menu_message_action_items;TS.templates.menu_message_action_items=function(e){var t=$("<div>").html(p(e)),a=$("<li>",{id:"hide_link","class":"danger","data-ts-message-id":TS.templates.makeMsgDomId(e.msg.ts)}).html("<a>Hide message (for me)</a>");return t.find("li.divider").length||t.append($("<li>",{"class":"divider"})),t.append(a),t.html()};var h=TS.templates.member;TS.templates.member=function(e){var t=h(e),a=$("<div>").html(t),n=$("<img>");n.attr("src",e.member.profile.image_24),n.css("display","inline-block"),n.css("margin","0 0 5px 5px"),n.css("border-radius","3px"),n.css("height","20px"),n.css("width","20px");var i=a.find("i.slackbot_icon");return i.length?n.insertAfter($(i)):n.insertAfter(a.find("span.presence").first()),a.html()};var _=TS.templates.channel;TS.templates.channel=function(e){var t=_(e);return i(t,"channel")};var u=TS.templates.group;TS.templates.group=function(e){var t=u(e);return i(t,"group")};var f=TS.templates.message;TS.templates.message=function(e){var t=f(e),a=$("<div>").html(t),n=a.find("ts-message").first().attr("id"),i=JSON.parse(window.localStorage.getItem(s));return i&&i.hasOwnProperty(n)&&i[n]?"":t};var g=TS.templates.channel_header;TS.templates.channel_header=function(e){var t=$("<div>").html(g(e));if(boot_data.hasOwnProperty("other_accounts")&&Object.keys(boot_data.other_accounts).length){var a=$("<div>",{"class":"team_list_info"}),n=Object.keys(boot_data.other_accounts);n.forEach(function(e){var t='<a class="blue_hover channel_actions_toggle channel_header_icon ts_tip ts_tip_bottom" href="'+boot_data.other_accounts[e].team_url+'"><span class="ts_tip_tip">'+boot_data.other_accounts[e].team_name+'</span><img style="border-radius:3px;width:24px;height:24px;margin:4px 3px 0 0" src="'+boot_data.other_accounts[e].team_icon.image_34+'"></a>';a.append(t)}),a.append('<div class="divider_bar">'),t.append(a)}return t.html()},$(document.body).on("click",'[id="channel_info_change"]',function(e){e.preventDefault(),l.show(TS.shared.getActiveModelOb().name),TS.menu.end()}),$(document.body).on("click",'[id="hide_link"]',function(e){var t=$(this).data("ts-message-id"),a=JSON.parse(window.localStorage.getItem(s));a=a?a:{},a[t]=!0,window.localStorage.setItem(s,JSON.stringify(a)),TS.client.msg_pane.rebuildMsgs()}),a()},t=document.createElement("script");t.type="text/javascript",t.innerHTML="("+e.toString()+")();",document.body.appendChild(t)}();