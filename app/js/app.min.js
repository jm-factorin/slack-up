!function(){var e=function(){function e(e){var t=$("li.channel",e);t.sort(function(e,t){function n(e){var t=$(e).find("span.overflow_ellipsis").first().clone().text().trim().replace(/\r?\n/g,"");return"#"==t.substring(0,1)&&(t=t.substring(1).trim()),t}return n(e).localeCompare(n(t))}),e.empty(),t.each(function(t,n){e.append(n)})}function t(){TS.client.channel_pane.rebuildStarredList(),TS.client.channel_pane.rebuildChannelList()}var n="conf_hide_msg_ids",a={escape:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},getData:function(e){var t=window.localStorage.getItem(a.getChannelKey(e));return t?JSON.parse(t):{icon:"",alias:""}},getChannelKey:function(e){return"conf_sidebar_"+e},html:function(){return'<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button><h3>Set info for channel #<span id="ch_title"></span></h3></div><div class="modal-body"><p>Change channel emoji icon. Paste your emoji name here like <code>:book:</code></p><input type="text" id="ch_icon" value="" class="with-emoji-menu" style="display:inline-block; width: 100%"/><p style="margin-top: 20px">Add channel alias. Set a custom sidebar name for this channel</p><input type="text" id="ch_alias" value="" style="display:inline-block; width: 100%"/></p></div><div class="modal-footer"><a class="btn btn_save">Save</a></div>'},show:function(e){var n=$("div#change_icon_dialog");n.length||(n=$("<div>",{id:"change_icon_dialog","class":"modal hide fade in","aria-hidden":"false"}).html(a.html()),$(document.body).append(n));var i=a.getData(TS.model.active_cid);n.find("#ch_icon").val(i.icon),n.find("#ch_alias").val($("<span>").html(i.alias).text()),n.find("span#ch_title").text(e),n.find("span.ch_preview").click(function(e){TS.emoji_menu.startEmo(e,"#ch_icon")}),n.find("a.btn_save").click(function(e){e.preventDefault(),window.localStorage.setItem(a.getChannelKey(TS.model.active_cid),JSON.stringify({icon:a.escape($("#ch_icon").val().trim()),alias:a.escape($("#ch_alias").val().trim())})),t(),n.modal("hide")}),n.modal("show")}},i=TS.client.channel_pane.rebuildStarredList;TS.client.channel_pane.rebuildStarredList=function(){i(),e($("ul#starred-list"))};var s=TS.client.channel_pane.rebuildChannelList;TS.client.channel_pane.rebuildChannelList=function(){s(),e($("ul#channel-list"))};var l=TS.client.msg_pane.rebuildMsgs;TS.client.msg_pane.rebuildMsgs=function(){l();var e=$("div.day_container");e.length&&e.each(function(e,t){var n=$(t),a=n.find("div.day_msgs");a.length&&""!=a.first().html()||n.remove()})};var r=TS.templates.menu_channel_items;TS.templates.menu_channel_items=function(e){var t=$("<div>").html(r(e)),n=$("<li>",{id:"channel_info_change"}).html("<a>Set Channel Info</a>");return n.insertAfter(t.find("li.divider").first()),t.html()};var c=TS.templates.builders.buildMsgHTML;TS.templates.builders.buildMsgHTML=function(e,t){var n=c(e,t);try{var a=$("<div>").html(n),i=a.find("ts-message").first().attr("id"),s=a.find("div.action_hover_container"),l=$("<a>").attr("data-action","hide").attr("data-ts-message-id",i).addClass("ts_icon ts_icon_archive").addClass("ts_tip ts_tip_top ts_tip_float ts_tip_delay_600 ts_tip_hidden").append($("<span>").addClass("ts_tip_tip").html("Hide for me"));return l.insertAfter(s.find('a[data-action="copy_link"]')),a.html()}catch(r){return console.error(r),n}};var o=TS.templates.member;TS.templates.member=function(e){var t=o(e),n=$("<div>").html(t),a=$("<img>");a.css("display","inline-block"),a.css("margin","0 0 5px 5px"),a.css("border-radius","3px"),a.css("height","20px"),a.css("width","20px");var i=n.find("span.presence")[0],s=n.find("i.slackbot_icon")[0];if(s)a.attr("src","https://slack.global.ssl.fastly.net/66f9/img/slackbot_24.png"),a.insertAfter($(s));else{var l=TS.members.getMemberById($(i).data("member-presence"));a.attr("src",l.profile.image_24),a.insertAfter($(i))}return n.html()};var d=TS.templates.channel;TS.templates.channel=function(e){var t=d(e),n=$("<div>").html(t),i=n.find("a.channel_name").data("channel-id"),s=n.find("a.channel_name").attr("href");try{var l=a.getData(i);if(!l.icon&&!l.alias)return t;var r=n.find("span.overflow_ellipsis");r.empty();try{var c=$(TS.emoji.graphicReplace(l.icon,{force_img:!0}));c.attr("src")?c.css("margin","-2px 3px 0 "):c=$("<ts-icon>").attr("class","ts_icon_channel_pane_hash prefix")}catch(o){c=$("<ts-icon>").attr("class","ts_icon_channel_pane_hash prefix")}var p=l.alias?l.alias:s.split("/")[2];return r.prepend(c),r.append(p),n.html()}catch(o){return console.error(o),t}};var p=TS.templates.message;TS.templates.message=function(e){var t=p(e),a=$("<div>").html(t),i=a.find("ts-message").first().attr("id"),s=JSON.parse(window.localStorage.getItem(n));return s&&s.hasOwnProperty(i)&&s[i]?"":t},$(document.body).on("click",'[id="channel_info_change"]',function(e){e.preventDefault(),a.show(TS.menu.channel.name),TS.menu.end()}),$(document.body).on("click",'[data-action="hide"]',function(e){var t=$(e.target).data("ts-message-id"),a=JSON.parse(window.localStorage.getItem(n));a=a?a:{},a[t]=!0,window.localStorage.setItem(n,JSON.stringify(a)),TS.client.msg_pane.rebuildMsgs()}),t()},t=document.createElement("script");t.type="text/javascript",t.innerHTML="("+e.toString()+")();",document.body.appendChild(t)}();