!function(){var e=function(){function e(e){var t=$("li",e);t.sort(function(e,t){function n(e){var t=$(e).find("span.overflow_ellipsis").first().clone().text().trim().replace(/\r?\n/g,"");return"#"==t.substring(0,1)&&(t=t.substring(1).trim()),t}return n(e).localeCompare(n(t))}),e.empty(),t.each(function(t,n){e.append(n)})}function t(){TS.client.channel_pane.rebuildGroupList(),TS.client.channel_pane.rebuildStarredList(),TS.client.channel_pane.rebuildChannelList()}function n(e){var t=$("<div>").html(e),n=$("<li>",{id:"channel_info_change"}).html("<a>Set Channel Info</a>");return n.insertAfter(t.find("li.divider").first()),t.html()}function a(e,t){var n=$("<div>").html(e),a=n.find("a."+t+"_name").attr("href"),i=n.find("a."+t+"_name").data(t+"-id"),s="group"==t?"ts_icon_lock":"ts_icon_channel_pane_hash";try{var l=r.getData(i);if(!l.icon&&!l.alias)return e;var c=n.find("span.overflow_ellipsis");c.empty();try{var o=$(TS.emoji.graphicReplace(l.icon,{force_img:!0}));o.attr("src")?o.css("margin","-2px 3px 0 "):o=$("<ts-icon>").attr("class",s+" prefix")}catch(d){o=$("<ts-icon>").attr("class",s+" prefix")}"group"==t&&n.find("ts-icon").first().remove();var m=l.alias?l.alias:a.split("/")[2];return c.prepend(o),c.append(m),n.html()}catch(d){return console.error(d),e}}var i="conf_hide_msg_ids",r={getData:function(e){var t=window.localStorage.getItem(r.getChannelKey(e));return t?JSON.parse(t):{icon:"",alias:""}},getChannelKey:function(e){return"conf_sidebar_"+e},html:function(){return'<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button><h3>Set info for channel #<span id="ch_title"></span></h3></div><div class="modal-body"><p>Change channel emoji icon. Paste your emoji name here like <code>:book:</code></p><input type="text" id="ch_icon" value="" class="with-emoji-menu" style="display:inline-block; width: 100%"/><p style="margin-top: 20px">Add channel alias. Set a custom sidebar name for this channel</p><input type="text" id="ch_alias" value="" style="display:inline-block; width: 100%"/></p></div><div class="modal-footer"><a class="btn btn_save">Save</a></div>'},show:function(e){var n=$("div#change_icon_dialog");n.length||(n=$("<div>",{id:"change_icon_dialog","class":"modal hide fade in","aria-hidden":"false"}).html(r.html()),$(document.body).append(n));var a=r.getData(TS.model.active_cid);n.find("#ch_icon").val(a.icon),n.find("#ch_alias").val($("<span>").html(a.alias).text()),n.find("span#ch_title").text(e),n.find("span.ch_preview").click(function(e){TS.emoji_menu.startEmo(e,"#ch_icon")}),n.find("a.btn_save").click(function(e){e.preventDefault(),window.localStorage.setItem(r.getChannelKey(TS.model.active_cid),JSON.stringify({icon:TS.utility.htmlEntities($("#ch_icon").val().trim()),alias:TS.utility.htmlEntities($("#ch_alias").val().trim())})),t(),n.modal("hide")}),n.modal("show")}},s=TS.client.channel_pane.rebuildStarredList;TS.client.channel_pane.rebuildStarredList=function(){s(),e($("ul#starred-list"))};var l=TS.client.channel_pane.rebuildChannelList;TS.client.channel_pane.rebuildChannelList=function(){l(),e($("ul#channel-list"))};var c=TS.client.msg_pane.rebuildMsgs;TS.client.msg_pane.rebuildMsgs=function(){c();var e=$("div.day_container");e.length&&e.each(function(e,t){var n=$(t),a=n.find("div.day_msgs");a.length&&""!=a.first().html()||n.remove()})};var o=TS.templates.menu_channel_items;TS.templates.menu_channel_items=function(e){return n(o(e))};var d=TS.templates.menu_group_items;TS.templates.menu_group_items=function(e){return n(d(e))};var m=TS.templates.builders.buildMsgHTML;TS.templates.builders.buildMsgHTML=function(e,t){var n=m(e,t);try{var a=$("<div>").html(n),i=a.find("ts-message").first().attr("id"),r=a.find("div.action_hover_container"),s=$("<a>").attr("data-action","hide").attr("data-ts-message-id",i).addClass("ts_icon ts_icon_archive").addClass("ts_tip ts_tip_top ts_tip_float ts_tip_delay_600 ts_tip_hidden").append($("<span>").addClass("ts_tip_tip").html("Hide for me"));return s.insertAfter(r.find('a[data-action="copy_link"]')),a.html()}catch(l){return console.error(l),n}};var p=TS.templates.member;TS.templates.member=function(e){var t=p(e),n=$("<div>").html(t),a=$("<img>");a.css("display","inline-block"),a.css("margin","0 0 5px 5px"),a.css("border-radius","3px"),a.css("height","20px"),a.css("width","20px");var i=n.find("span.presence")[0],r=n.find("i.slackbot_icon")[0];if(r)a.attr("src","https://slack.global.ssl.fastly.net/66f9/img/slackbot_24.png"),a.insertAfter($(r));else{var s=TS.members.getMemberById($(i).data("member-presence"));a.attr("src",s.profile.image_24),a.insertAfter($(i))}return n.html()};var h=TS.templates.channel;TS.templates.channel=function(e){var t=h(e);return a(t,"channel")};var u=TS.templates.group;TS.templates.group=function(e){var t=u(e);return a(t,"group")};var f=TS.templates.message;TS.templates.message=function(e){var t=f(e),n=$("<div>").html(t),a=n.find("ts-message").first().attr("id"),r=JSON.parse(window.localStorage.getItem(i));return r&&r.hasOwnProperty(a)&&r[a]?"":t},$(document.body).on("click",'[id="channel_info_change"]',function(e){e.preventDefault(),r.show(TS.shared.getActiveModelOb().name),TS.menu.end()}),$(document.body).on("click",'[data-action="hide"]',function(e){var t=$(e.target).data("ts-message-id"),n=JSON.parse(window.localStorage.getItem(i));n=n?n:{},n[t]=!0,window.localStorage.setItem(i,JSON.stringify(n)),TS.client.msg_pane.rebuildMsgs()}),t()},t=document.createElement("script");t.type="text/javascript",t.innerHTML="("+e.toString()+")();",document.body.appendChild(t)}();